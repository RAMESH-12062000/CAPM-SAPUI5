const { readProject } = require('../../projectReader')
const { merge, sort } = require('../../merge')

module.exports = class TogglesTemplate extends require('../../plugin') {

  static hasInProduction(env) {
    return !!env.requires?.toggles
  }

  async run() {
    const project = readProject()
    const { isNodejs, configFile } = project
    await merge(__dirname, 'files/package.json.hbs').into(configFile, { with: project })
    if (isNodejs) await sort('package.json', 'dependencies')
  }
}
